(this["webpackJsonpra-hw11-api-thunk"]=this["webpackJsonpra-hw11-api-thunk"]||[]).push([[0],{28:function(e,t,r){"use strict";r.r(t);var n=r(0),c=r(10),a=r.n(c),i=r(7),s=r(3),o=r(4),l=r(2),u="REMOVE_SERVICE",j="CHANGE_ADD_FIELD",b="CHANGE_EDIT_FIELD",d="FILTER_SERVICE",h="CHANGE_FILTER_FIELD",O="CLEAR_FORM",v="CLEAR_FILTER",p="FETCH_SERVICES_REQUEST",f="FETCH_SERVICES_SUCCESS",m="FETCH_SERVICES_FAILED",E="ADD_SERVICES_REQUEST",g="ADD_SERVICES_SUCCESS",_="ADD_SERVICES_FAILED",S="EDIT_SERVICES_REQUEST",x="EDIT_SERVICES_SUCCESS",y="EDIT_SERVICES_FAILED";function C(){return{type:O}}function F(e){return{type:m,payload:{error:e}}}function w(){return{type:S}}function D(e){return{type:x,payload:{item:e}}}function I(e){return{type:y,payload:{error:e}}}var R=function(){return function(e){return e({type:p}),fetch("https://antis-ra-hw-thunk.herokuapp.com/api/services").then((function(e){if(console.log("fetchGetServices_response: ",e),e.status<200||e.status>=300)throw new Error("\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430.");return e.json()})).then((function(t){console.log("fetchGetServices_result: ",t),e({type:f,payload:{services:t}})})).catch((function(t){console.log("fetchServices_Get_Error_text: ",t.message),e(F(t.message))}))}},T=function(e){return function(t){return t(function(e){return{type:u,payload:{id:e}}}(e)),fetch("https://antis-ra-hw-thunk.herokuapp.com/api/services/"+e,{method:"DELETE"}).then((function(e){if(console.log("fetchDeleteService_response: ",e),e.status<200||e.status>=300)throw new Error("\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430.");t(R())})).catch((function(e){console.log("fetchDeleteServicet_Error_text: ",e.message),t(F(e.message))}))}},L=function(){return function(e,t){var r=t().serviceAdd.item;return console.log("fetchServices_item: ",r),e({type:E}),fetch("https://antis-ra-hw-thunk.herokuapp.com/api/services",{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(Object(l.a)(Object(l.a)({},r),{},{id:0}))}).then((function(t){if(console.log(t),t.ok||console.log("ServiceForm_handleSubmit_fetchServices_result:",t.status,t.statusText),t.status<200||t.status>=300)throw new Error("\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430.");e({type:g}),e(R())})).catch((function(t){var r;console.log("ServiceForm_handleSubmit_fetchServices_Error_text: ",t.message),e((r=t.message,{type:_,payload:{error:r}}))}))}},k=r.p+"static/media/mcru-ajax-loader.6f9ac78c.gif",A=r(1);function N(){return Object(A.jsx)("div",{className:"loader",children:Object(A.jsx)("img",{src:k,alt:"LOADING..."})})}function V(){var e=Object(o.c)((function(e){return e.serviceEdit})),t=e.item,r=e.loading,c=e.error,a=Object(s.g)(),i=Object(s.h)(),u=Object(o.b)();Object(n.useEffect)((function(){var e;u((e=i.id,function(t){return t(w()),fetch("https://antis-ra-hw-thunk.herokuapp.com/api/services/"+e).then((function(e){if(e.status<200||e.status>=300)throw new Error("\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430.");return e.json()})).then((function(e){t(D(e))})).catch((function(e){console.log("fetchServices_Get_Error_text: ",e.message),t(I(e.message))}))}))}),[u,i.id]);var j=function(e){var t=e.target,r=t.name,n=t.value;u(function(e,t){return{type:b,payload:{name:e,value:t}}}(r,n))};return r&&Object(A.jsx)(N,{})||c||Object(A.jsxs)("form",{onSubmit:function(e){e.preventDefault(),!t.name||!t.price||t.price<=0||(u(w()),u(function(e){return function(t,r){var n=r().serviceEdit.item;return console.log("fetchPostEditServices_item: ",n),fetch("https://antis-ra-hw-thunk.herokuapp.com/api/services",{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(Object(l.a)({},n))}).then((function(r){if(console.log(r),r.ok||console.log("ServiceForm_handleSubmit_fetchServices_result.statusText:",r.status,r.statusText),r.status<200||r.status>=300)throw new Error("\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430.");t(D()),e("/")})).catch((function(e){console.log("ServiceForm_handleSubmit_fetchServices_Error_text: ",e.message),t(I(e.message))}))}}(a)))},onReset:function(e){u(C()),a("/")},children:[Object(A.jsx)("h3",{children:"Edit service:"}),Object(A.jsxs)("label",{children:["Name ",Object(A.jsx)("input",{name:"name",onChange:j,value:t.name})]}),Object(A.jsxs)("label",{children:["Price",Object(A.jsx)("input",{name:"price",type:"number",onChange:j,value:t.price})]}),Object(A.jsxs)("label",{children:["Content",Object(A.jsx)("input",{name:"content",onChange:j,value:t.content})]}),Object(A.jsx)("button",{type:"submit",disabled:r||!t.name||!t.price||t.price<=0,children:"Save"}),Object(A.jsx)("button",{type:"reset",disabled:r,children:"Close"}),Object(A.jsx)("div",{children:c})]})}function G(){var e=Object(o.c)((function(e){return e.serviceAdd})),t=e.item,r=e.loading,n=e.error,c=Object(o.b)(),a=function(e){var t=e.target,r=t.name,n=t.value;c(function(e,t){return{type:j,payload:{name:e,value:t}}}(r,n))};return Object(A.jsxs)("form",{onSubmit:function(e){e.preventDefault(),!t.name||!t.price||t.price<=0||c(L())},onReset:function(e){c(C())},children:[Object(A.jsx)("h3",{children:"Add service:"}),Object(A.jsxs)("label",{children:["Name ",Object(A.jsx)("input",{name:"name",onChange:a,value:t.name})]}),Object(A.jsxs)("label",{children:["Price",Object(A.jsx)("input",{name:"price",type:"number",onChange:a,value:t.price})]}),Object(A.jsx)("button",{type:"submit",disabled:r||!t.name||!t.price||t.price<=0,children:"Save"}),Object(A.jsx)("button",{type:"reset",disabled:r,children:"Cancel"}),Object(A.jsx)("div",{children:n})]})}function U(){var e=Object(o.c)((function(e){return e.serviceFilter})).filter,t=Object(o.c)((function(e){return e.serviceList})).activeFilter,r=Object(o.b)();return Object(A.jsx)("label",{children:Object(A.jsxs)("form",{onSubmit:function(t){t.preventDefault(),r({type:d,payload:{setFilter:e}})},onReset:function(){r({type:v})},children:[Object(A.jsx)("h3",{children:"Filter services:"}),Object(A.jsxs)("div",{children:["Active filter: ",t?'"'.concat(t,'"'):"NO"]}),Object(A.jsx)("input",{name:"filter",onChange:function(e){var t=e.target.value;r(function(e){return{type:h,payload:{filter:e}}}(t))},value:e}),Object(A.jsx)("button",{type:"submit",children:"Set"}),Object(A.jsx)("button",{type:"reset",children:"Clear"})]})})}function H(){var e=Object(o.c)((function(e){return e.serviceList})),t=e.services,r=e.activeFilter,c=e.loading,a=e.error,i=Object(s.g)(),l=Object(o.b)();Object(n.useEffect)((function(){l(R())}),[l]);var u=t.filter((function(e){return e.name.toLowerCase().includes(r.toLowerCase())})),j=(u.length?u:t).map((function(e){return Object(A.jsxs)("li",{children:[e.name," ",e.price,Object(A.jsx)("button",{disabled:e.loading,onClick:function(){var t;(t=e.id)&&i("/services/"+t)},children:"\u270e"}),Object(A.jsx)("button",{disabled:e.loading,onClick:function(){return t=e.id,void l(T(t));var t},children:"\u2715"})]},e.id)}));return Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)(G,{}),Object(A.jsx)(U,{}),c&&Object(A.jsx)(N,{})||a||Object(A.jsx)("ul",{children:!u.length&&r?"Nothing to display. Try another filter string!":j})]})}function P(){return Object(A.jsxs)("div",{className:"page-404",children:[Object(A.jsx)("div",{className:"page-404__header",children:"404"}),Object(A.jsx)("div",{className:"page-404__main",children:"\u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430..."}),Object(A.jsx)(i.b,{to:"/",children:"\u041f\u0435\u0440\u0435\u0439\u0442\u0438 \u043d\u0430 \u0433\u043b\u0430\u0432\u043d\u0443\u044e \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443"})]})}r(27);function J(){return Object(A.jsx)(i.a,{children:Object(A.jsx)("div",{className:"page",children:Object(A.jsxs)(s.d,{children:[Object(A.jsx)(s.b,{path:"/services/:id",element:Object(A.jsx)(V,{})}),Object(A.jsx)(s.b,{path:"/services",element:Object(A.jsx)(H,{})}),Object(A.jsx)(s.b,{path:"/",element:Object(A.jsx)(s.a,{to:"/services"})}),Object(A.jsx)(s.b,{path:"*",element:Object(A.jsx)(P,{})})]})})})}var M=r(9),Q={services:[],activeFilter:"",loading:!1,error:null};var X=r(8),B={item:{name:"",price:""},loading:!1,error:null};var q={item:{id:"",name:"",price:"",content:""},loading:!1,error:null};var z={filter:""};var K=r(15),W=Object(M.b)({serviceList:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Q,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case p:return Object(l.a)(Object(l.a)({},e),{},{loading:!0,error:null});case f:var r=t.payload.services;return Object(l.a)(Object(l.a)({},e),{},{loading:!1,services:r});case m:var n=t.payload.error;return Object(l.a)(Object(l.a)({},e),{},{loading:!1,error:n});case u:var c=t.payload.id,a=e.services.find((function(e){return e.id===c}));return a&&(a.loading=!0),Object(l.a)({},e);case d:var i=t.payload.setFilter;return Object(l.a)(Object(l.a)({},e),{},{activeFilter:i});case v:return Object(l.a)(Object(l.a)({},e),{},{activeFilter:Q.activeFilter});default:return e}},serviceAdd:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:B,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case j:var r=t.payload,n=r.name,c=r.value;return Object(l.a)(Object(l.a)({},e),{},{item:Object(l.a)(Object(l.a)({},e.item),{},Object(X.a)({},n,c))});case O:return Object(l.a)(Object(l.a)({},e),{},{item:B.item});case g:return Object(l.a)({},B);case E:return Object(l.a)(Object(l.a)({},e),{},{loading:!0,error:null});case _:var a=t.payload.error;return Object(l.a)(Object(l.a)({},e),{},{loading:!1,error:a});default:return e}},serviceEdit:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:q,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case b:var r=t.payload,n=r.name,c=r.value;return Object(l.a)(Object(l.a)({},e),{},{item:Object(l.a)(Object(l.a)({},e.item),{},Object(X.a)({},n,c))});case O:return Object(l.a)(Object(l.a)({},e),{},{item:q.item});case x:var a=t.payload.item;return a?Object(l.a)(Object(l.a)({},e),{},{loading:!1,item:a}):Object(l.a)({},q);case S:return Object(l.a)(Object(l.a)({},e),{},{loading:!0,error:null});case y:var i=t.payload.error;return Object(l.a)(Object(l.a)({},e),{},{loading:!1,error:i});default:return e}},serviceFilter:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:z,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case h:var r=t.payload.filter;return Object(l.a)(Object(l.a)({},e),{},{filter:r});case v:return Object(l.a)({},z);default:return e}}}),Y=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||M.c,Z=Object(M.d)(W,Y(Object(M.a)(K.a)));a.a.render(Object(A.jsx)(o.a,{store:Z,children:Object(A.jsx)(J,{})}),document.getElementById("root"))}},[[28,1,2]]]);
//# sourceMappingURL=main.2d1485dd.chunk.js.map